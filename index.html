
<!doctype html>
<html lang="pt-BR"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>RPG de Tarefas</title>
<link rel="icon" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAACRElEQVR42u3dvVEDMRBAYawhoggHDBERQ0BIDY4pAjogcAfQA8TUQEhASEjgRiByYnsYOM7nXe33Qv+NtPu0Okl349nZycXXEcrShIAAIAAIAAKAACAACAACgAAgAAgAAoAAIAAIAAKAACAACAACgAAgAAgAAoAAIAAIAAKAACAACAACIDbHY/3Q6fxcNCfmc/WhAiBIBcjGzeVy67Xn93sCVEz85nuVRGiSP/xzBOgw+dUkaJJfWwKrgOI0o792FVABVAAQAAQAAbrkv7t6ve8KqgAqQP8MHcUVzgTKVIC/JrPKgVCpKeC3Sa10GljuOHidXPcDFBWgcrKtAhBbgOXiqUTQI/WzRQtK7xJE6+dsrD+OvFpcD/7u7fxh67XH1V13yR+7n28vr31UgF1B2BUsye94CuhxxGfob4sclF6qwGY/Isneoo+M7BJETn6afYCsEmRod0gBergozLKyCVsBMkuQaVkbegrIKEG2PY3w1wCZJMi4oZXiIjDrHkGGdreswYxWBaIv99ILEFmCrMlPJ0DEtXb2jap0AkS6KOzhFDNlBdgM8qGCHqUdJaeAdbAPHfQo7RhKiBtCMIxubgiBKQAEAAFAABAABAABQAAQAAQAAUAAEAAEAAFAAAQUYIy7UzB9vFUAFSCelZguzi1y47D/+LYMjcT+4toyNVbyx2e05wJ+wjMDcQfSJAKgyCoABAABQAAQAAQAAUAAEAAEAAFAABAABAABQAAQAAQAAUAAEAAEAAFAABAABAABQADsnW+KLrYDYgd1tgAAAABJRU5ErkJggg=="/>
<style>
:root{--accent:#C084FC}
*{box-sizing:border-box}
html,body{height:100%;margin:0;font-family:Inter,Arial,Helvetica,sans-serif;background:linear-gradient(180deg,#08020f,#2b0a44);color:#eef2ff}
.container{max-width:980px;margin:0 auto;padding:14px;z-index:1}
.header{display:flex;justify-content:space-between;align-items:center}
.title{font-weight:900;font-size:20px}
.center{display:flex;gap:12px;margin-top:12px}
.left{flex:1}
.panel{background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(0,0,0,0.03));padding:12px;border-radius:12px}
.avatarBox{width:300px;height:260px;border-radius:12px;display:flex;align-items:center;justify-content:center;background:linear-gradient(180deg,rgba(76,29,149,0.45),rgba(31,6,74,0.45));border:3px solid rgba(192,148,255,0.12)}
.avatarBox img{width:192px;height:192px;image-rendering:pixelated}
.invList{max-height:440px;overflow:auto;margin-top:8px}
.item{display:flex;align-items:center;gap:8px;padding:8px;border-radius:8px;background:rgba(255,255,255,0.01);margin-bottom:6px}
.item img{width:64px;height:64px;image-rendering:pixelated}
.slot{padding:10px;border-radius:8px;background:rgba(255,255,255,0.03);text-align:center}
.button{padding:8px 10px;border-radius:8px;border:none;cursor:pointer}
.primary{background:var(--accent);color:#111;font-weight:800}
.rarity{padding:4px 8px;border-radius:6px;font-weight:900}
.r1{background:#cfcfcf;color:#111} .r2{background:#6fe18a;color:#083} .r3{background:#66b3ff;color:#013} .r4{background:#c084fc;color:#211} .r5{background:#ffd166;color:#432} .r6{background:#ff96c8;color:#421}
.footer{text-align:center;margin-top:12px;color:#aaa}
@media(max-width:820px){ .center{flex-direction:column} .avatarBox{width:220px;height:200px} .avatarBox img{width:160px;height:160px} }
</style>
</head><body>
<div class="container">
  <div class="header"><div class="title">RPG de Tarefas</div><div><button id="openSettings" class="button">☰</button></div></div>

  <div id="startPanel" class="panel" style="margin-top:12px;text-align:center">
    <h2 style="margin:6px 0;color:#e9d6ff">RPG de Tarefas</h2>
    <div style="max-width:720px;margin:0 auto;color:#dcd3f8">Bem-vindo aventureiro — escolha seu gênero, tema e trilha sonora antes de partir. O áudio será ativado quando você tocar em <strong>Iniciar Jornada</strong>.</div>
    <div style="display:flex;gap:8px;justify-content:center;margin-top:12px">
      <button id="maleBtn" class="button">Masculino</button>
      <button id="femaleBtn" class="button">Feminino</button>
    </div>
    <div style="display:flex;gap:8px;justify-content:center;margin-top:8px">
      <button id="modeBtn" class="button">Modo: Escuro</button>
      <button id="musicBtn" class="button">Música: Intermediária</button>
    </div>
    <div style="margin-top:12px"><button id="startBtn" class="button primary">Iniciar Jornada</button></div>
  </div>

  <div id="gameUI" style="display:none">
    <div class="center">
      <div class="left panel">
        <div style="display:flex;justify-content:space-between;align-items:center"><strong>Inventário</strong><div>Agendadas: <span id="scheduledCount">0</span></div></div>
        <div style="margin-top:8px;display:flex;gap:8px;align-items:center">
          <input id="newTitle" placeholder="Nova tarefa..." style="flex:1;padding:8px;border-radius:8px;border:none;background:rgba(255,255,255,0.02);color:#fff"/>
          <select id="newType"><option value="diaria">Diária</option><option value="semanal">Semanal</option><option value="mensal">Mensal</option></select>
          <select id="newImp"><option value="1">Sem muita importância</option><option value="2">Importante</option><option value="3">Muito importante</option><option value="4">Essencial</option></select>
          <input id="newXP" placeholder="XP" style="width:70px;padding:8px;border-radius:8px;border:none;background:rgba(255,255,255,0.02);color:#fff"/>
          <button id="addTask" class="button">Adicionar</button>
        </div>

        <div class="invList" id="itemsContainer"></div>

        <div style="margin-top:10px;display:flex;gap:8px">
          <button id="openChest" class="button">Abrir baú</button>
          <button id="gainXP" class="button primary">Simular vitória (+XP)</button>
          <button id="loseXP" class="button" style="background:#ef4444;color:#fff">Simular falha</button>
        </div>
      </div>

      <div style="width:340px;display:flex;flex-direction:column;gap:10px;align-items:center">
        <div class="avatarBox panel"><img id="avatarImg" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAByklEQVR42u3dsU7CQACA4aPpYBjccHTwARjQxIUYXXkYd57AxYfhDVgYdHBh8h1cDHFww8mkJA0hnNje3fctRmITof/dNfQCg4twsw0RqlCFqOMrx3d6fKBoAhAAAkAACAABIAAEgAAQAAJAAAgAAZCr2v38tI/ffG3MAETMAH37h77Hd9m/6OfvL64BEAACQAAIAAEgAASAABAAAkAACIDTq1O/H57kqGs85/j7+T4fAAEgAASAABAAAkAACAABIAD2qnN5Ih9vT6+H/u3oen7r1JsBEAACKP0awH6A/9fcA9D55zMYA5YABIAAKPMiMJcn4s0dMwACIJklYDh7bH38rIRX/XLS+vDn4tkMgAAQAAJAAAgAAXDS9wHcz+/RaDzitbQfAAEgAASAABAAAkAACAABIAAEgAAQAAKghf0AfRqN9gNgCUAACAABIAAEgAAQAAJAAAgAASAABMDfsB+gT6PRfgAsAQgAASAABEB3AazWy72/U8AM8HvSnXxLAKUGYPQXHMB0/LDzE0sAmRlcDe+3UQVF3oxofpHycQWn/eXXnR9vDFgCKFhtCrcEYAlAAAgAASAABIAAEAACQAAIAAEgAARAdn4AySkraoouY7gAAAAASUVORK5CYII=" alt="avatar"/></div>
        <div class="slot panel slot">Arma: <div id="slotWeaponName" style="font-weight:800"></div></div>
        <div class="slot panel slot">Armadura: <div id="slotArmorName" style="font-weight:800"></div></div>
        <div class="slot panel slot">Cosmético: <div id="slotCosName" style="font-weight:800"></div></div>
        <div style="width:100%" class="panel">Nível <span id="level">1</span> — XP: <span id="xp">0</span>/<span id="xpNext">100</span>
          <div style="height:12px;width:100%;background:#372847;border-radius:8px;margin-top:6px;overflow:hidden"><div id="xpBar" style="height:100%;width:0%;background:linear-gradient(90deg,#7be3ff,#c084fc)"></div></div>
        </div>
      </div>
    </div>

    <div style="margin-top:12px" class="panel">
      <strong>Configurações rápidas</strong>
      <div style="display:flex;gap:8px;margin-top:8px;align-items:center">
        <label>Volume <input id="vol" type="range" min="0" max="1" step="0.01" value="0.6"/></label>
        <label style="margin-left:12px">Trilha: <select id="trackSel"><option value="calm">Tranquila</option><option value="mid" selected>Intermediária</option><option value="intense">Agitada</option></select></label>
      </div>
    </div>
  </div>

  <div style="height:20px"></div>
  <div class="footer">RPG de Tarefas — Baú metálico com runas roxas • Avatar inicia com pijama azul (escuro/claro)</div>
</div>

<script>
const STORAGE_KEY = 'rpg_de_tarefas_v1';
let state = { character:{gender:'male', level:1, xp:0, equipped:{weapon:null,armor:null,cos:null}}, inventory:[], tasks:[], settings:{mode:'dark',track:'mid',volume:0.6} };
try{ const s = localStorage.getItem(STORAGE_KEY); if(s) state = JSON.parse(s); }catch(e){ console.warn('no save') }
function save(){ localStorage.setItem(STORAGE_KEY, JSON.stringify(state)); }

const ITEMS = [{"file": "item_0.png", "name": "Espada R1", "type": "weapon", "rarity": 1, "dataUri": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAABwUlEQVR42u3dsU7CQACA4bZpjJODk5MP4YILcYCJB3DU0Y0nYWNhJXHwIVjYYOFhOrrgpGm0GqGUtnffN6qNtvy9K+Vi0+tssE9qyLIssX2Pt0+ImgAEgAAQAAJAAAgAASAABIAAEAACQACEKvd5er+3L4rCCECNEaBrf9DbYhX8QX+aTlwDIAAEgAAQAAJAAAgAASAABIAAEADN6/16gF6edaV9rv15vv8PgAAQAAJAAAgAASAABIAAEAB/y0PZkYfni+1/f3a9fB946Y0ACAABxH4NYD3A+ZXXAHheAKYABIAAaOUiMJQdcXPHCIAAOFR6czls5bmBr9O5o//N4+zFfQBMAQgAASAABIAAaFLu8/wOnY1HHEv3ARAAAkAACAABIAAEgAAQAAJAAAgAASAAKlgP0KWz0XoATAEIAAEgAASAABAAAkAACAABIAAEgAA4DesBunQ2Wg+AKQABIAAEgABo/m3gb9/Y7FY/vnZ/N3bEYgnAi24K+BoJqkYDjADEchFoFIh8CiBc6e3VqJWHRn0qP0i5jd8f/fbOAVMAMb8LMISbAjAFIAAEgAAQAAJAAAgAASAABIAAEAACIDgfVWAxFY8IIKkAAAAASUVORK5CYII=", "rarityName": "Comum"}, {"file": "item_1.png", "name": "Espada R2", "type": "weapon", "rarity": 2, "dataUri": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAABwUlEQVR42u3dsU7CQACA4bZpnJicmJh8BkkcjBPs+gDuhIn4DMwOTm5u7k6sbPA4DbtOmAaBgLW2vfu+UW205e9dKReb9i9uPpMKsixLbN/h7ROiJgABIAAEgAAQAAJAAAgAASAABIAAEAChyn2e3u3ti6IwAlBhBGjbH/T68hH8QZ/OHlwDIAAEgAAQAAJAAAgAASAABIAAEAD16/x6gE6edaV9rvx5vv8PgAAQAAJAAAgAASAABIAAEADH5aHsyPixtzr1Zxdvm6GX3giAABBA7NcA1gP8v/IaAM8LwBSAABAAjVwEhrIjbu4YARAA50oHvbtGnhv4Ppk7+jvun5/cB8AUgAAQAAJAAAiAOuU+z2/R2fiLY+k+AAJAAAgAASAABIAAEAACQAAIAAEgAATAHtYDtOlstB4AUwACQAAIAAEgAASAABAAAkAACAABIAD+hvUAbTobrQfAFIAAEAACQADU/zbw0DeW68WPr91ejx2xWALwopsCvkeCfaMBRgBiuQg0CkQ+BRCu9Opy1MhDo7bKD1Ju4vdHv71zwBRAzO8CDOGmAEwBCAABIAAEgAAQAAJAAAgAASAABIAACM4XA8UxB4o/TXkAAAAASUVORK5CYII=", "rarityName": "Incomum"}, {"file": "item_2.png", "name": "Espada R3", "type": "weapon", "rarity": 3, "dataUri": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAABx0lEQVR42u3dIU7DUACA4bapQhEEEjW1C5CQoMAMARdYMrcjkAyHRyC4AHaZwUyhSbgMohdgakuzFTIope173yeBBtr9fa/rXmh6cnD+mdSQZVli+x5vnxA1AQgAASAABIAAEAACQAAIAAEgAASAAAhV7vP0fm9fFIURgBojQNf+oIfHefAH/e527BoAASAABIAAEAACQAAIAAEgAASAAGhe79cD9PKsK+1z7c/z/X8ABIAAEAACQAAIAAEgAASAAPheHsqO3EyO3vf92Zfnj1MvvREAASCA2K8BrAf4f+U1AJ4XgCkAASAAWrkIDGVH3NwxAiAAfiodHF608tzAxXTm6G+5frp3HwBTAAJAAAgAASAAmpT7PL9DZ+MvjqX7AAgAASAABIAAEAACQAAIAAEgAASAABAAFawH6NLZaD0ApgAEgAAQAAJAAAgAASAABIAAEAACQAD8DesBunQ2Wg+AKQABIAAEgABo/m3gV994fVvufO3y7MoRiyUAL7opYDMSVI0GGAGI5SLQKBD5FEC40uHxqJWHRq2VH6Tcxu+PfnvngCmAmN8FGMJNAZgCEAACQAAIAAEgAASAABAAAkAACAABEJwVshsw+YMsJX0AAAAASUVORK5CYII=", "rarityName": "Raro"}, {"file": "item_3.png", "name": "Armadura R1", "type": "armor", "rarity": 1, "dataUri": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAABwUlEQVR42u3dsU7CQACA4bZpCBMDkxMPwQKLYYCJB3CU0Y0ncXNxNXHwIVjcYOFhOrLgRFKJGqHWtnfftxijjbT8vYNysekwmxyTCrIsS2zf4e0ToiYAASAABIAAEAACQAAIAAEgAASAABAAocp9nt7t7YuiMAJQYQRo2wN6e94Ef9Dv10uvARAAAkAACAABIAAEgAAQAAJAAAiA+nV+PUAnz7rSPlf+PN//B0AACAABIAAEgAAQAAJAAAiAn+Wh7Mhs1dv99nffXw4TT70RAAEggNhfA1gP8P/KawDcLwBTAAJAADTyIjCUHXFxxwiAALhUetO/beS+ga/rJ0f/zN3jg+sAmAIQAAJAAAgAAVCn3Of5LTobrziWrgMgAASAABAAAkAACAABIAAEgAAQAAJAAHzBeoA2nY3WA2AKQAAIAAEgAASAABAAAkAACAABIAAEwN+wHqBNZ6P1AJgCEAACQAAIgPrfBn73g+1+8+n76XjhaMU0AnjCTQFCiDmA0xRw/hUjALG+CzAKhCcdDeaN3DTqpHwj5Sb+fvTbOwdMAUQsN4SbAjAFIAAEgAAQAAJAAAgAASAABIAAEAACIDgfjcUvbfO+XlcAAAAASUVORK5CYII=", "rarityName": "Comum"}, {"file": "item_4.png", "name": "Armadura R2", "type": "armor", "rarity": 2, "dataUri": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAABwUlEQVR42u3dsU7CQACA4bZpnJicmJx8BkkYiJPs+gDuxsnwDMwMTGxs7k6sbvA4DbtOJJUoQUppe/d9izHaSMvfOygXm/avhl9JBVmWJbbv8PYJUROAABAAAkAACAABIAAEgAAQAAJAAAiAUOU+T+/29kVRGAGoMAK07QEt5h/BH/TXtyevARAAAkAACAABIAAEgAAQAAJAAAiA+nV+PUAnz7rSPlf+PN//B0AACAABIAAEgAAQAAJAAAiAw/JQdmT83Fsf+7ur5XbgqTcCIAAEEPtrAOsBLq+8BsD9AjAFIAAEQCMvAkPZERd3jAAIgP9Kb3r3jdw38P1l6ujveZxNXAfAFIAAEAACQAAIgDrlPs9v0dl4wrF0HQABIAAEgAAQAAJAAAgAASAABIAAEAAC4BfWA7TpbLQeAFMAAkAACAABIAAEgAAQAAJAAAgAASAAzsN6gDadjdYDYApAAAgAASAA6n8b+NcPPjerH9+P7saOVkwjgCfcFCCEmAPYTQH7XzECEOu7AKNAeNLb64dGbhq1U76RchN/P/rtnQOmACKWG8JNAZgCEAACQAAIAAEgAASAABAAAkAACAABEJxvs5wvee4ddxoAAAAASUVORK5CYII=", "rarityName": "Incomum"}, {"file": "item_5.png", "name": "Armadura R3", "type": "armor", "rarity": 3, "dataUri": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAByElEQVR42u3dMU7CUACA4bbp5GQYHJ2cuACJiRMuOOgFSNg4ggls7A4OXIDVuLgwOZt4GYdeQCaSStAopbZ97/sWY7SRlr/vQXmx6fnJ1WdSQZZlie07vH1C1AQgAASAABAAAkAACAABIAAEgAAQAAIgVLnP07u9fVEURgAqjABte0APj0/BH/T5/dhrAASAABAAAkAACAABIAAEgAAQAAKgfp1fD9DJs660z5U/z/f/ARAAAkAACAABIAAEgAAQAALgZ3koO3I36b3/9ndfVh8DT70RAAEggNhfA1gP8P/KawDcLwBTAAJAADTyIjCUHXFxxwiAAPir9OJ02Mh9A5+nM0d/x+1y4ToApgAEgAAQAAJAANQp93l+i87GA46l6wAIAAEgAASAABAAAkAACAABIAAEgAAQAHtYD9Cms9F6AEwBCAABIAAEgAAQAAJAAAgAASAABIAAOA7rAdp0NloPgCkAASAABIAAqP9t4Hc/eH1bf/n++vLG0YppBPCEmwKEEHMA2ylg9ytGAGJ9F2AUCE/aPxs1ctOorfKNlJv4+9Fv7xwwBRCx3BBuCsAUgAAQAAJAAAgAASAABIAAEAACQAAIgOBsANlzL4W2iBAMAAAAAElFTkSuQmCC", "rarityName": "Raro"}, {"file": "item_6.png", "name": "Cajado R1", "type": "weapon", "rarity": 1, "dataUri": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAByUlEQVR42u3dsU7CQACA4bZpjBODk5MP4YILYdDJB2DUkY0nYWNxNXHwIVjYYPFhOrLgQJpUYghaStu779uMNkr7967Qi01vsuEuqSHLssT2Pd4+IWoCEAACQAAIAAEgAASAABAAAkAACAABEKrc/fR+b18UhRGAGiNA1/6gz7dl8Dv9ZfbsGgABIAAEgAAQAAJAAAgAASAABIAAaF7v1wP08qyrvOba9/P9fwAEgAAQAAJAAAgAASAABIAAOC4P5YWMX682p/7s6n07dOiNAAgAAcR+DWA9wOVV1wB4XgCmAASAAGjlIjCUF+LDHSMAAuCv0tvrUSvPDfyYLez9A5P51OcAmAIQAAJAAAgAAdCk3P38Dp2N/9iXPgdAAAgAASAABIAAEAACQAAIAAEgAASAAPiF9QBdOhutB8AUgAAQAAJAAAgAASAABIAAEAACQAAIgPOwHqBLZ6P1AJgCEAACQAAIgObfBh775vpr+ePrh/sneyyWEaA8+A56xCOAM981AALYTweH1wMEHkA57LsWCFt6N3hs5aFRpeqDlNv4/dFv7xwwBRDz20BDuCkAUwACQAAIAAEgAASAABAAAkAACAABIACC8w2zozAdbKxkfAAAAABJRU5ErkJggg==", "rarityName": "Comum"}, {"file": "item_7.png", "name": "Cajado R2", "type": "weapon", "rarity": 2, "dataUri": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAByUlEQVR42u3dsU7CQACA4bZpmJicnJh8BkgcjBPs8ADuxon4DM4MTG5u7k6sbPg4DbsOpkklhoi1tL37vs1oo7R/7wq92PRycP2R1JBlWWL7Hm+fEDUBCAABIAAEgAAQAAJAAAgAASAABIAACFXufnq/ty+KwghAjRGga3/Q8/ot+J3+sFy4BkAACAABIAAEgAAQAAJAAAgAASAAmtf79QC9POsqr7n2/Xz/HwABIAAEgAAQAAJAAAgAASAAjstDeSGzu+Hutz+7edlPHHojAAJAALFfA1gPcH7VNQCeF4ApAAEgAFq5CAzlhfhwxwiAADhVOhretvLcwNf7J3v/wHz16HMATAEIAAEgAASAAGhS7n5+h87GP+xLnwMgAASAABAAAkAACAABIAAEgAAQAAJAAPzAeoAunY3WA2AKQAAIAAEgAASAABAAAkAACAABIAAEwP+wHqBLZ6P1AJgCEAACQAAIgObfBh775vZ98+3rm/HMHotlBCgPvoMe8QjgzHcNgAC+poPD6wECD6Ac9l0LhC29upi28tCoUvVBym38/ui3dw6YAoj5baAh3BSAKQABIAAEgAAQAAJAAAgAASAABIAAEADB+QTF1DA2/OSE7QAAAABJRU5ErkJggg==", "rarityName": "Incomum"}, {"file": "item_8.png", "name": "Cajado R3", "type": "weapon", "rarity": 3, "dataUri": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAABz0lEQVR42u3dIU7DUACA4bapQhEEcmqKC5CQTIEBsV2AZG5HIAGHR0xwAeyCwaDQJFxmohfYBGnSNWQBSmn73vc5Ag2s/ftet77QdHQw2SQNZFmW2H7A2ydETQACQAAIAAEgAASAABAAAkAACAABIABClbufPuzti6IwAtBgBOjbH/SwXAW/0+9url0DIAAEgAAQAAJAAAgAASAABIAAEADtG/x6gEGedZXX3Ph+vv8PgAAQAAJAAAgAASAABIAAEAD75aG8kNn86OO7P/vytD516I0ACAABxH4NYD3A/6uuAfC8AEwBCAAB0MlFYCgvxIc7RgAEwE+l48PzTp4b+Ly4tfdrpo/3PgfAFIAAEAACQAAIgDbl7uf36Gz8xb70OQACQAAIAAEgAASAABAAAkAACAABIAAEwBesB+jT2Wg9AKYABIAAEAACQAAIAAEgAASAABAAAkAA/A3rAfp0NloPgCkAASAABIAAaP9t4L5vvr2/7nx9cXZlj8UyApQH30GPeARw5rsGQACf00H9eoDAAyiHfdcCYUtPji87eWhUqfog5S5+f/TbOwdMAcT8NtAQbgrAFIAAEAACQAAIAAEgAASAABAAAkAACIDgbAHYBTBPOgtvZAAAAABJRU5ErkJggg==", "rarityName": "Raro"}, {"file": "item_9.png", "name": "Capa R1", "type": "cos", "rarity": 1, "dataUri": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAByUlEQVR42u3dsU7CQACA4bZpjBODk5MP4YILYdDJB2DUkY0nYWNxNXHwIVjYYPFhOrLgQJpUYghaStu779uMNkr7967Qi01vsuEuqSHLssT2Pd4+IWoCEAACQAAIAAEgAASAABAAAkAACAABEKrc/fR+b18UhRGAGiNA1/6gz7dl8Dv9ZfbsGgABIAAEgAAQAAJAAAgAASAABIAAaF7v1wP08qyrvOba9/P9fwAEgAAQAAJAAAgAASAABIAAOC4P5YWMX682p/7s6n07dOiNAAgAAcR+DWA9wOVV1wB4XgCmAASAAGjlIjCUF+LDHSMAAuCv0tvrUSvPDfyYLez9A5P51OcAmAIQAAJAAAgAAdCk3P38Dp2N/9iXPgdAAAgAASAABIAAEAACQAAIAAEgAASAAPiF9QBdOhutB8AUgAAQAAJAAAgAASAABIAAEAACQAAIgPOwHqBLZ6P1AJgCEAACQAAIgObfBh775vpr+ePrh/sneyyWEaA8+A56xCOAM981AALYTweH1wMEHkA57LsWCFt6N3hs5aFRpeqDlNv4/dFv7xwwBRDz20BDuCkAUwACQAAIAAEgAASAABAAAkAACAABIACC8w2zozAdbKxkfAAAAABJRU5ErkJggg==", "rarityName": "Comum"}, {"file": "item_10.png", "name": "Capa R2", "type": "cos", "rarity": 2, "dataUri": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAByUlEQVR42u3dsU7CQACA4bZpmJicnJh8BkgcjBPs8ADuxon4DM4MTG5u7k6sbPg4DbsOpkklhoi1tL37vs1oo7R/7wq92PRycP2R1JBlWWL7Hm+fEDUBCAABIAAEgAAQAAJAAAgAASAABIAACFXufnq/ty+KwghAjRGga3/Q8/ot+J3+sFy4BkAACAABIAAEgAAQAAJAAAgAASAAmtf79QC9POsqr7n2/Xz/HwABIAAEgAAQAAJAAAgAASAAjstDeSGzu+Hutz+7edlPHHojAAJAALFfA1gPcH7VNQCeF4ApAAEgAFq5CAzlhfhwxwiAADhVOhretvLcwNf7J3v/wHz16HMATAEIAAEgAASAAGhS7n5+h87GP+xLnwMgAASAABAAAkAACAABIAAEgAAQAAJAAPzAeoAunY3WA2AKQAAIAAEgAASAABAAAkAACAABIAAEwP+wHqBLZ6P1AJgCEAACQAAIgObfBh775vZ98+3rm/HMHotlBCgPvoMe8QjgzHcNgAC+poPD6wECD6Ac9l0LhC29upi28tCoUvVBym38/ui3dw6YAoj5baAh3BSAKQABIAAEgAAQAAJAAAgAASAABIAAEADB+QTF1DA2/OSE7QAAAABJRU5ErkJggg==", "rarityName": "Incomum"}, {"file": "item_11.png", "name": "Capa R3", "type": "cos", "rarity": 3, "dataUri": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAABz0lEQVR42u3dIU7DUACA4bapQhEEcmqKC5CQTIEBsV2AZG5HIAGHR0xwAeyCwaDQJFxmohfYBGnSNWQBSmn73vc5Ag2s/ftet77QdHQw2SQNZFmW2H7A2ydETQACQAAIAAEgAASAABAAAkAACAABIABClbufPuzti6IwAtBgBOjbH/SwXAW/0+9url0DIAAEgAAQAAJAAAgAASAABIAAEADtG/x6gEGedZXX3Ph+vv8PgAAQAAJAAAgAASAABIAAEAD75aG8kNn86OO7P/vytD516I0ACAABxH4NYD3A/6uuAfC8AEwBCAAB0MlFYCgvxIc7RgAEwE+l48PzTp4b+Ly4tfdrpo/3PgfAFIAAEAACQAAIgDbl7uf36Gz8xb70OQACQAAIAAEgAASAABAAAkAACAABIAAEwBesB+jT2Wg9AKYABIAAEAACQAAIAAEgAASAABAAAkAA/A3rAfp0NloPgCkAASAABIAAaP9t4L5vvr2/7nx9cXZlj8UyApQH30GPeARw5rsGQACf00H9eoDAAyiHfdcCYUtPji87eWhUqfog5S5+f/TbOwdMAcT8NtAQbgrAFIAAEAACQAAIAAEgAASAABAAAkAACIDgbAHYBTBPOgtvZAAAAABJRU5ErkJggg==", "rarityName": "Raro"}];
const AVATARS = { male_dark: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAByklEQVR42u3dsU7CQACA4aPpYBjccHTwARjQxIUYXXkYd57AxYfhDVgYdHBh8h1cDHFww8mkJA0hnNje3fctRmITof/dNfQCg4twsw0RqlCFqOMrx3d6fKBoAhAAAkAACAABIAAEgAAQAAJAAAgAAZCr2v38tI/ffG3MAETMAH37h77Hd9m/6OfvL64BEAACQAAIAAEgAASAABAAAkAACIDTq1O/H57kqGs85/j7+T4fAAEgAASAABAAAkAACAABIAD2qnN5Ih9vT6+H/u3oen7r1JsBEAACKP0awH6A/9fcA9D55zMYA5YABIAAKPMiMJcn4s0dMwACIJklYDh7bH38rIRX/XLS+vDn4tkMgAAQAAJAAAgAAXDS9wHcz+/RaDzitbQfAAEgAASAABAAAkAACAABIAAEgAAQAAKghf0AfRqN9gNgCUAACAABIAAEgAAQAAJAAAgAASAABMDfsB+gT6PRfgAsAQgAASAABEB3AazWy72/U8AM8HvSnXxLAKUGYPQXHMB0/LDzE0sAmRlcDe+3UQVF3oxofpHycQWn/eXXnR9vDFgCKFhtCrcEYAlAAAgAASAABIAAEAACQAAIAAEgAARAdn4AySkraoouY7gAAAAASUVORK5CYII=", female_dark: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAABz0lEQVR42u3dvU3DQACA0bN1FQNQUSAGSIUUCYEEDTUj0GSDFExAyQL0FNT0FNCkzRAZIKKHCmSRgMCHsX33XglYws7nO/8prnbD4WtIUIc6JC1fW77X5QNFE4AAEAACQAAIAAEgAASAABAAAkAACIBcRffzx738+mVtBCBhBBjaP7R/eZP9Rl/dXTkGQAAIAAEgAASAABAAAkAACAABIAC6F8d+P3yUe11jndPv5/t+AASAABAAAkAACAABIAAEgAD4VsxlRZ5up4uf/u3JbDH10RsBEAACKP0YwPMA/6/5DEDv389gHzAFIAAEQJkHgbmsiIs7RgAEwG9Ve/Eo7b2BLc9Dz6/vbf1PHuYXrgNgCkAACAABIAAEQJei+/kD2htbbEvXARAAAkAACAABIAAEgAAQAAJAAAgAASAAtvA8wJD2Rs8DYApAAAgAASAABIAAEAACQAAIAAEgAATA3/A8wJD2Rs8DYApAAAgAASAAuj8N/OoXz8vHjZ8dT85ssVIC8KGbAj5Ggm2jAUYAHARSxBRAvqqDndNeXhr1rvki5XYFj/vl170vbx8wBVDyWYAh3BSAKQABIAAEgAAQAAJAAAgAASAABIAAEADZeQNnqit6ZLqGMgAAAABJRU5ErkJggg==", male_light: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAByklEQVR42u3dQUrDQABA0UnI2k1XvUg9QY/gYQT3Ba/iKQpueg4XtQsVgmBBJK6E2Cq0mWozM+/tRIPN+GcSkkiqx4e3LkSo6zqUvX1Ie/tA0QQgAASAABAAAkAACAABIAAEgAAQAAIgV437+SHp7dt2awUgYgUY2we6XW6yH/Sb+dQ5AAJAAAgAASAABIAAEAACQAAIAAHw95J/HiDJWdfb5ej7+bHjbw44BCAABIAAEAACQAAIAAEgAHLX5LIji6vp6tCfvb5bX/rTWwEQAAIo/Rwg9f/PT1H/GYCzj7854BCAABAAZZ4E5rIjLu5YARAAx6qeNx9neW/g/frd6O+YTbp/G38rAAJAAAIwBAJAAAiAIjXu549oNg4YTNcBEAACQAAIAAEgAASAABAAAkAACAABIAB+0MTez/c8wAlno+cBcAhAAAgAASAABIAAEAACQAAIAAEgAATAaXgeYEyzcdDzAFYABIAAEAACQAAIgMOvA/z2jfbp+9cXE4NV9AqwGwQFBPA1681+KwACIEfV60sX+dKouA/Qf5HysN9fF769FQABMPg6gCU88SXcIQABIAAEgAAQAAJAAAgAASAABIAAEAACYN8nSwYtQCztQkMAAAAASUVORK5CYII=", female_light: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAB0UlEQVR42u3dv07CQADA4WvTGQYWFxd9CAdnJ5+XhyC+gAuTiw5grCa6GJiM559E6UHo3X3fpAmNtPzurtAamvu7101I0LZtqHv7kPf2gaoJQAAIAAEgAASAABAAAkAACAABIAAEQKk61/ND1tv3/ZsZgIQZYGxPaH3zXPxBP7mcOgdAAAgAASAABIAAEAACQAAIAAEgAA4v+/sBshx10S4nX89PPf7GgCUAASAABIAAEAACQAAIAAFQuq6UHTm/ni7++9jl/OnCS28GQAAIoPZzgNz/Pz9H8T0ARz/+xoAlAAEgAOo8CSxlR3y4YwZAAOyqWT+8H+V7A2/nS0f/m7OrU58DYAlAAAgAASAABMAhda7nj2g0DjiYPgdAAAgAASAABIAAEAACQAAIAAEgAASAAPhFl3o93/0AexyN7gfAEoAAEAACQAAIAAEgAASAABAAAkAACID9cD/AmEbjoPsBzAAIAAEgAATAru8C/npAv/r8eTJzwKoK4OPF98JXuATEI79fff2dCgKIR/1kZhZwEogAcA5AYZqXx03il0alPYH4i5SH/f228u0tAQiAoTpTeOZTuCUAASAABIAAEAACQAAIAAEgAASAABAAAuCnLRZwODbcyg/lAAAAAElFTkSuQmCC" };
const CHEST_URI = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAACRElEQVR42u3dvVEDMRBAYawhoggHDBERQ0BIDY4pAjogcAfQA8TUQEhASEjgRiByYnsYOM7nXe33Qv+NtPu0Okl349nZycXXEcrShIAAIAAIAAKAACAACAACgAAgAAgAAoAAIAAIAAKAACAACAACgAAgAAgAAoAAIAAIAAKAACAACAACIDbHY/3Q6fxcNCfmc/WhAiBIBcjGzeVy67Xn93sCVEz85nuVRGiSP/xzBOgw+dUkaJJfWwKrgOI0o792FVABVAAQAAQAAbrkv7t6ve8KqgAqQP8MHcUVzgTKVIC/JrPKgVCpKeC3Sa10GljuOHidXPcDFBWgcrKtAhBbgOXiqUTQI/WzRQtK7xJE6+dsrD+OvFpcD/7u7fxh67XH1V13yR+7n28vr31UgF1B2BUsye94CuhxxGfob4sclF6qwGY/Isneoo+M7BJETn6afYCsEmRod0gBergozLKyCVsBMkuQaVkbegrIKEG2PY3w1wCZJMi4oZXiIjDrHkGGdreswYxWBaIv99ILEFmCrMlPJ0DEtXb2jap0AkS6KOzhFDNlBdgM8qGCHqUdJaeAdbAPHfQo7RhKiBtCMIxubgiBKQAEAAFAABAABAABQAAQAAQAAUAAEAAEAAFAAAQUYIy7UzB9vFUAFSCelZguzi1y47D/+LYMjcT+4toyNVbyx2e05wJ+wjMDcQfSJAKgyCoABAABQAAQAAQAAUAAEAAEAAFAABAABAABQAAQAAQAAUAAEAAEAAFAABAABAABQADsnW+KLrYDYgd1tgAAAABJRU5ErkJggg==";

function xpToNext(l){ return Math.floor(100*Math.pow(1.35,l-1)); }
function renderXP(){ document.getElementById('level').textContent = state.character.level; document.getElementById('xp').textContent = state.character.xp; document.getElementById('xpNext').textContent = xpToNext(state.character.level); const pct = Math.max(4, Math.min(100, Math.round((state.character.xp/xpToNext(state.character.level))*100))); document.getElementById('xpBar').style.width = pct + '%'; save(); }
function updateAvatarImage(){ const el = document.getElementById('avatarImg'); const m = state.character.gender; const mode = state.settings.mode; if(m==='male'){ el.src = mode==='dark' ? AVATARS.male_dark : AVATARS.male_light; } else { el.src = mode==='dark' ? AVATARS.female_dark : AVATARS.female_light; } if(state.character.equipped.armor) el.src = state.character.equipped.armor.dataUri; else if(state.character.equipped.cos) el.src = state.character.equipped.cos.dataUri; }

function renderInventory(){ const container = document.getElementById('itemsContainer'); container.innerHTML=''; if(state.inventory.length===0) { container.innerHTML = '<div style="color:#aaa;padding:10px">Inventário vazio</div>'; return; } state.inventory.forEach((it,idx)=>{ const el = document.createElement('div'); el.className='item'; el.innerHTML = `<img src="${it.dataUri}"/><div style="flex:1"><div style="font-weight:900">${it.name}</div><div class="rarity r${it.rarity}">${it.rarityName}</div></div>`; const btnEq = document.createElement('button'); btnEq.textContent='Equipar'; btnEq.className='button'; btnEq.onclick = ()=>{ equipItem(idx); }; const btnDel = document.createElement('button'); btnDel.textContent='Descartar'; btnDel.className='button'; btnDel.onclick = ()=>{ state.inventory.splice(idx,1); renderInventory(); save(); }; el.appendChild(btnEq); el.appendChild(btnDel); container.appendChild(el); }); }

function equipItem(index){ const it = state.inventory[index]; if(!it) return; if(it.type==='weapon'){ state.character.equipped.weapon = it; document.getElementById('slotWeaponName').textContent = it.name; } if(it.type==='armor'){ state.character.equipped.armor = it; document.getElementById('slotArmorName').textContent = it.name; } if(it.type==='cos'){ state.character.equipped.cos = it; document.getElementById('slotCosName').textContent = it.name; } updateAvatarImage(); save(); renderInventory(); showEquipEffect(); }

function showEquipEffect(){ const rect = document.createElement('div'); rect.style.position='fixed'; rect.style.left='50%'; rect.style.top='20%'; rect.style.transform='translateX(-50%)'; rect.style.padding='12px 20px'; rect.style.background='linear-gradient(90deg,rgba(192,132,252,0.9),rgba(123,227,255,0.9))'; rect.style.borderRadius='12px'; rect.style.zIndex=9999; rect.textContent='Equipado!'; document.body.appendChild(rect); setTimeout(()=>rect.remove(),900); }

function openChest(){ const r = Math.random()*100; let wanted; if(r<2) wanted=6; else if(r<8) wanted=5; else if(r<20) wanted=4; else if(r<42) wanted=3; else if(r<70) wanted=2; else wanted=1; const candidates = ITEMS.filter(x=>x.rarity===wanted); const pick = candidates.length? candidates[Math.floor(Math.random()*candidates.length)] : ITEMS[Math.floor(Math.random()*ITEMS.length)]; const it = Object.assign({}, pick); state.inventory.push(it); renderInventory(); save(); animateChest(); alert('Você abriu um baú metálico e recebeu: ' + it.name); }

function animateChest(){ const img = document.createElement('img'); img.src = CHEST_URI; img.style.position='fixed'; img.style.left='50%'; img.style.top='50%'; img.style.transform='translate(-50%,-50%) scale(1)'; img.style.width='180px'; img.style.zIndex=9999; document.body.appendChild(img); setTimeout(()=>img.remove(),900); }

document.getElementById('addTask').addEventListener('click', ()=>{ const title = document.getElementById('newTitle').value.trim(); if(!title) return alert('Nome da tarefa?'); const type = document.getElementById('newType').value; const imp = Number(document.getElementById('newImp').value); const xp = Number(document.getElementById('newXP').value) || 20; const t = {id:'t-'+Math.random().toString(36).slice(2,9),title,type,importance:imp,xp,created:Date.now(),done:false}; state.tasks.unshift(t); document.getElementById('newTitle').value=''; document.getElementById('scheduledCount').textContent = state.tasks.length; save(); openChest(); gainXP(xp); });

function xpToNext(l){ return Math.floor(100*Math.pow(1.35,l-1)); }
function gainXP(amount){ state.character.xp += amount; while(state.character.xp >= xpToNext(state.character.level)){ state.character.xp -= xpToNext(state.character.level); state.character.level++; } renderXP(); }
document.getElementById('gainXP').addEventListener('click', ()=>{ gainXP(25); });
document.getElementById('loseXP').addEventListener('click', ()=>{ const loss = Math.round(state.character.xp*0.3); state.character.xp = Math.max(0, state.character.xp-loss); renderXP(); alert('Penalidade: -'+loss+' XP'); });

let audioCtx=null, musicInterval=null, masterGain=null;
function initAudio(){ try{ audioCtx = new (window.AudioContext || window.webkitAudioContext)(); masterGain = audioCtx.createGain(); masterGain.gain.value = state.settings.volume || 0.6; masterGain.connect(audioCtx.destination); }catch(e){ console.warn('audio not supported') } }
function playNote(freq, type, dur, vol){ if(!audioCtx) return; const o = audioCtx.createOscillator(); const g = audioCtx.createGain(); o.type = type; o.frequency.value = freq; g.gain.value = vol; o.connect(g); g.connect(masterGain); o.start(); o.stop(audioCtx.currentTime + dur); }
function startMusic(kind){ if(!audioCtx) return; stopMusic(); if(kind==='calm'){ musicInterval = setInterval(()=>{ playNote(220,'sine',1,0.02); setTimeout(()=>playNote(330,'sine',0.8,0.015),300); },1800); } if(kind==='mid'){ musicInterval = setInterval(()=>{ playNote(196,'triangle',0.6,0.025); setTimeout(()=>playNote(294,'triangle',0.5,0.02),200); },1400); } if(kind==='intense'){ musicInterval = setInterval(()=>{ playNote(164,'square',0.35,0.03); setTimeout(()=>playNote(246,'square',0.25,0.02),120); },900); } }
function stopMusic(){ if(musicInterval) clearInterval(musicInterval); musicInterval = null; }

document.getElementById('maleBtn').addEventListener('click', ()=>{ state.character.gender='male'; save(); updateAvatarImage(); });
document.getElementById('femaleBtn').addEventListener('click', ()=>{ state.character.gender='female'; save(); updateAvatarImage(); });
document.getElementById('modeBtn').addEventListener('click', ()=>{ state.settings.mode = state.settings.mode==='dark'?'light':'dark'; document.getElementById('modeBtn').textContent = 'Modo: ' + (state.settings.mode==='dark'?'Escuro':'Claro'); save(); updateAvatarImage(); });
document.getElementById('musicBtn').addEventListener('click', ()=>{ const order=['calm','mid','intense']; const cur = state.settings.track || 'mid'; const next = order[(order.indexOf(cur)+1)%order.length]; state.settings.track = next; document.getElementById('musicBtn').textContent = 'Música: ' + (next==='calm'?'Tranquila': next==='mid'?'Intermediária':'Agitada'); save(); });

document.getElementById('vol').addEventListener('input', (e)=>{ state.settings.volume = Number(e.target.value); if(masterGain) masterGain.gain.value = state.settings.volume; save(); });

document.getElementById('startBtn').addEventListener('click', ()=>{ document.getElementById('startPanel').style.display='none'; document.getElementById('gameUI').style.display='block'; initAudio(); startMusic(state.settings.track||'mid'); renderInventory(); renderXP(); updateAvatarImage(); save(); registerSW(); });

function registerSW(){ if(!('serviceWorker' in navigator)) return; const swCode = "const CACHE_NAME='rpg-de-tarefas-cache-v1';const PRECACHE=[location.href, location.pathname];self.addEventListener('install',e=>{e.waitUntil(caches.open(CACHE_NAME).then(c=>c.addAll(PRECACHE)).then(()=>self.skipWaiting()));});self.addEventListener('activate',e=>e.waitUntil(self.clients.claim()));self.addEventListener('fetch',e=>{e.respondWith(caches.match(e.request).then(r=>r||fetch(e.request).then(res=>{try{ if(e.request.method==='GET'&&res&&res.status===200){ const c=res.clone(); caches.open(CACHE_NAME).then(cache=>cache.put(e.request,c)).catch(()=>{});} }catch(er){} return res; }).catch(()=>caches.match(location.pathname))));});"; const blob = new Blob([swCode],{type:'application/javascript'}); const url = URL.createObjectURL(blob); navigator.serviceWorker.register(url).then(r=>console.log('sw registered',r)).catch(e=>console.warn(e)); }

// initialize UI values
document.getElementById('vol').value = state.settings.volume || 0.6;
document.getElementById('trackSel').value = state.settings.track || 'mid';
renderInventory(); renderXP(); updateAvatarImage();
</script>
</body></html>
