<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Grimório — Estante de Artes (SVG 128×128)</title>
<style>
  :root{
    --wood-top:#2b1a10; --wood-bottom:#1a0f07;
    --glow: rgba(138,78,237,0.14);
    --paper:#f0d88a;
    --text-dark:#231b20; --text-light:#efe9ff;
    --muted:#cfc6e8;
    --rar-common:#9e9e9e; --rar-rare:#4aa3ff; --rar-epic:#8a4efd; --rar-legend:#d4af37;
    --panel: rgba(255,255,255,0.02);
  }
  html,body{height:100%;margin:0;font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, Arial}
  body{
    background: linear-gradient(180deg,var(--wood-top),var(--wood-bottom));
    color:var(--text-light);
    -webkit-font-smoothing:antialiased;
    padding:18px;
  }
  .container{max-width:1280px;margin:0 auto}
  header{display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap}
  h1{margin:0;font-size:20px;color:var(--text-light);letter-spacing:0.6px}
  .controlsTop{display:flex;gap:8px;align-items:center}
  .btn{background:var(--text-light);color:#13072a;border-radius:8px;padding:8px 10px;border:none;font-weight:700;cursor:pointer}
  .toggle{padding:6px 8px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:var(--text-light);cursor:pointer}
  .small{color:var(--muted);font-size:13px}
  .shelf{margin-top:18px;padding:16px;border-radius:12px;background:linear-gradient(180deg,rgba(0,0,0,0.12),rgba(0,0,0,0.06));box-shadow:0 8px 40px rgba(0,0,0,0.6) inset;position:relative}
  .sectionTitle{color:#d9c8ff;font-weight:800;margin-top:6px;margin-bottom:12px;font-size:16px}
  .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(360px,1fr));gap:14px}
  .card{display:flex;gap:12px;align-items:flex-start;padding:12px;border-radius:10px;background:var(--panel);border:1px solid rgba(255,255,255,0.03)}
  .artWrap{width:140px;height:140px;display:flex;align-items:center;justify-content:center;border-radius:10px; background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.04)); box-shadow:inset 0 4px 12px rgba(0,0,0,0.5)}
  svg.asset{width:128px;height:128px;display:block}
  .meta{flex:1}
  .name{font-weight:900;font-size:15px}
  .rarity{display:inline-block;margin-top:6px;padding:6px 10px;border-radius:8px;font-weight:900;color:#111;margin-bottom:6px}
  .desc{color:var(--muted);font-style:italic;margin-top:6px}
  .avatarPreview{display:flex;gap:12px;align-items:center}
  .avatarBox{width:140px;height:140px;border-radius:10px;background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(0,0,0,0.06));display:flex;align-items:center;justify-content:center}
  footer{color:var(--muted);text-align:center;margin-top:18px}

  /* light theme */
  body.light{
    background: linear-gradient(180deg,#efe6d0,#e6d4a0);
    color:var(--text-dark);
  }
  body.light .toggle{color:var(--text-dark)}
  body.light .btn{background:var(--text-dark);color:var(--text-light)}
  body.light .rarity{color:#111}

  /* subtle animations for demo */
  @keyframes pulse {
    0% { filter: drop-shadow(0 0 0 rgba(138,78,237,0)); transform: translateY(0); }
    50% { filter: drop-shadow(0 0 8px rgba(138,78,237,0.5)); transform: translateY(-1px); }
    100% { filter: drop-shadow(0 0 0 rgba(138,78,237,0)); transform: translateY(0); }
  }
  .glowPulse { animation: pulse 2.2s ease-in-out infinite; }
  @media(max-width:760px){ .grid{grid-template-columns:1fr} .artWrap{width:120px;height:120px} .avatarBox{width:96px;height:96px} }
</style>
</head>
<body>
  <div class="container">
    <header>
      <div>
        <h1>Grimório das Artes do RPG de Tarefas</h1>
        <div class="small">Estante mágica — SVGs 128×128 com animações leves (transparentes)</div>
      </div>
      <div class="controlsTop">
        <div class="avatarPreview">
          <div class="avatarBox" id="avatarBox" title="Preview do avatar"></div>
        </div>
        <div style="display:flex;flex-direction:column;gap:6px;align-items:flex-end">
          <div>
            <button id="btnGender" class="toggle">Masculino</button>
            <button id="btnTheme" class="toggle">Tema Claro</button>
            <button id="btnExport" class="btn">Exportar (ZIP)</button>
          </div>
          <div class="small" style="text-align:right">Clique em um item para equipar no avatar</div>
        </div>
      </div>
    </header>

    <div class="shelf" id="shelfRoot"></div>

    <footer>RPG de Tarefas — Grimório das Artes — Visualização</footer>
  </div>

<script>
/* ========== Config & list of assets to create ========== */

/* items definitions: weapons, armors, cosmetics, chests, monsters (daily/weekly/monthly with importance levels) */
const ASSETS = [];
const rarities = [
  {k:'common', label:'Comum', color:'var(--rar-common)'},
  {k:'rare', label:'Raro', color:'var(--rar-rare)'},
  {k:'epic', label:'Épica', color:'var(--rar-epic)'},
  {k:'legend', label:'Lendária', color:'var(--rar-legend)'}
];

function pushWeapon(base){
  rarities.forEach(r=> ASSETS.push({category:'Armas', type:'weapon', key:base.toLowerCase(), name:`${base} — ${r.label}`, rarity:r.k, rarityLabel:r.label}));
}
function pushArmor(baseKey, baseName){
  rarities.forEach(r=> ASSETS.push({category:'Armaduras', type:'armor', key:baseKey, name:`${baseName} — ${r.label}`, rarity:r.k, rarityLabel:r.label}));
}
function pushCosmetic(key, name){
  rarities.forEach(r=> ASSETS.push({category:'Cosméticos', type:'cosmetic', key:key, name:`${name} — ${r.label}`, rarity:r.k, rarityLabel:r.label}));
}
function pushChest(){
  const names = ['Baú — Comum','Baú — Raro','Baú — Épico','Baú — Lendário'];
  rarities.forEach((r,i)=> ASSETS.push({category:'Baús', type:'chest', key:'chest', name:names[i], rarity:r.k, rarityLabel:r.label}));
}
function pushMonsters(){
  // for each mission type: daily, weekly, monthly and for each importance (1..4)
  const missions = ['Diária','Semanal','Mensal'];
  for(const m of missions){
    for(let imp=1; imp<=4; imp++){
      const lbl = `(${m} - Importância ${imp})`;
      ASSETS.push({category:'Monstros', type:'monster', key:m.toLowerCase(), name:`${m} — ${labelImportance(imp)}`, rarity:importanceToRarity(imp), rarityLabel: labelImportance(imp), importance:imp});
    }
  }
}
function labelImportance(i){
  if(i===1) return 'Sem muita importância';
  if(i===2) return 'Importante';
  if(i===3) return 'Muito importante';
  return 'Essencial';
}
function importanceToRarity(i){
  // map importance to visual intensity: 1->common,2->rare,3->epic,4->legend
  if(i===1) return 'common';
  if(i===2) return 'rare';
  if(i===3) return 'epic';
  return 'legend';
}

/* Basic lists */
const weapons = ['Espada','Cajado','Machado','Arco','Foice','Lança'];
weapons.forEach(w=> pushWeapon(w));
const armorModels = [
  {k:'tunica',n:'Túnica do Aventureiro'},
  {k:'guardiao',n:'Armadura do Guardião'},
  {k:'cacador',n:'Armadura do Caçador'},
  {k:'feiticeiro',n:'Armadura do Feiticeiro'},
  {k:'couraca',n:'Couraça Estelar'}
];
armorModels.forEach(a=> pushArmor(a.k,a.n));
pushCosmetic('capa','Capa (Curta)');
pushCosmetic('capa_long','Capa (Longa)');
pushCosmetic('chap_advent','Chapéu (Aventureiro)');
pushCosmetic('chap_mage','Chapéu (Mago)');
pushChest();
pushMonsters();

/* Add initial equipment (pijama + graveto) */
ASSETS.unshift({category:'Equipamento Inicial', type:'initial', key:'pijama', name:'Pijama do Herói — Comum', rarity:'common',rarityLabel:'Comum'});
ASSETS.unshift({category:'Equipamento Inicial', type:'initial', key:'graveto', name:'Graveto Inicial — Comum', rarity:'common',rarityLabel:'Comum'});

/* ========== helpers for creating SVG assets ========== */

function rarityColor(r){
  if(r==='common') return getComputedStyle(document.documentElement).getPropertyValue('--rar-common').trim();
  if(r==='rare') return getComputedStyle(document.documentElement).getPropertyValue('--rar-rare').trim();
  if(r==='epic') return getComputedStyle(document.documentElement).getPropertyValue('--rar-epic').trim();
  if(r==='legend') return getComputedStyle(document.documentElement).getPropertyValue('--rar-legend').trim();
  return '#9e9e9e';
}

/* Create an SVG element 128x128 with transparent background, animated depending on type and rarity */
function createAssetSVG(asset, gender='male'){
  const NS = "http://www.w3.org/2000/svg";
  const svg = document.createElementNS(NS,'svg');
  svg.setAttribute('viewBox','0 0 128 128');
  svg.setAttribute('width','128'); svg.setAttribute('height','128');
  svg.classList.add('asset');

  // defs: glow filter & gentle noise-like pattern for texture
  const defs = document.createElementNS(NS,'defs');
  defs.innerHTML = `
    <filter id="glow-${asset.rarity}" x="-50%" y="-50%" width="200%" height="200%">
      <feGaussianBlur stdDeviation="${asset.rarity==='common'?0: asset.rarity==='rare'?2: asset.rarity==='epic'?4:6}" result="coloredBlur"/>
      <feMerge><feMergeNode in="coloredBlur"/><feMergeNode in="SourceGraphic"/></feMerge>
    </filter>
    <linearGradient id="lg-${asset.rarity}" x1="0" x2="1">
      <stop offset="0" stop-color="${rarityGradientStart(asset.rarity)}" stop-opacity="0.12"/>
      <stop offset="1" stop-color="${rarityGradientEnd(asset.rarity)}" stop-opacity="0.02"/>
    </linearGradient>
    <radialGradient id="core-${asset.rarity}" cx="30%" cy="20%" r="60%">
      <stop offset="0" stop-color="${rarityGradientEnd(asset.rarity)}" stop-opacity="0.35"/>
      <stop offset="1" stop-color="${rarityGradientStart(asset.rarity)}" stop-opacity="0"/>
    </radialGradient>
  `;
  svg.appendChild(defs);

  // base group
  const g = document.createElementNS(NS,'g');
  // draw a soft backdrop (so transparent assets still read over wood)
  const bg = document.createElementNS(NS,'rect');
  bg.setAttribute('x','6'); bg.setAttribute('y','6'); bg.setAttribute('width','116'); bg.setAttribute('height','116');
  bg.setAttribute('rx','12'); bg.setAttribute('fill','url(#lg-'+asset.rarity+')');
  bg.setAttribute('opacity','0.9');
  g.appendChild(bg);

  // draw central artwork depending on type
  if(asset.type==='weapon'){
    drawWeaponSVG(svg,g,asset);
  } else if(asset.type==='armor'){
    drawArmorSVG(svg,g,asset);
  } else if(asset.type==='cosmetic'){
    drawCosmeticSVG(svg,g,asset);
  } else if(asset.type==='chest'){
    drawChestSVG(svg,g,asset);
  } else if(asset.type==='monster'){
    drawMonsterSVG(svg,g,asset);
  } else if(asset.type==='initial'){
    drawInitialSVG(svg,g,asset);
  } else {
    // fallback box
    const r = document.createElementNS(NS,'rect'); r.setAttribute('x',34); r.setAttribute('y',34); r.setAttribute('width',60); r.setAttribute('height',60); r.setAttribute('fill',rarityColor(asset.rarity)); g.appendChild(r);
  }

  svg.appendChild(g);
  return svg;
}

/* SIMPLE color helpers for gradient ends */
function rarityGradientStart(r){
  if(r==='common') return '#ffffff';
  if(r==='rare') return '#8ecbff';
  if(r==='epic') return '#cfa6ff';
  if(r==='legend') return '#ffe59a';
  return '#ffffff';
}
function rarityGradientEnd(r){
  if(r==='common') return '#d1d1d1';
  if(r==='rare') return '#4aa3ff';
  if(r==='epic') return '#8a4efd';
  if(r==='legend') return '#ffd166';
  return '#ffffff';
}

/* DRAWING primitive implementations: each makes shapes and adds light animation if rarity>common */

function drawWeaponSVG(svg,g,asset){
  const NS = "http://www.w3.org/2000/svg";
  const col = rarityColor(asset.rarity);

  // sword-like stylized shape depending on key
  const key = asset.key;
  // base handle
  const handle = document.createElementNS(NS,'rect'); handle.setAttribute('x',56); handle.setAttribute('y',36); handle.setAttribute('width',8); handle.setAttribute('height',48); handle.setAttribute('rx',3);
  handle.setAttribute('fill','#2c1b2a');
  g.appendChild(handle);

  if(key==='espada'){
    const blade = document.createElementNS(NS,'path'); blade.setAttribute('d','M64 12 L84 44 L64 52 L44 44 Z'); blade.setAttribute('fill',col); blade.setAttribute('stroke','#2a1624'); blade.setAttribute('stroke-width','1.5');
    g.appendChild(blade);
    addRunes(svg,g,asset);
  } else if(key==='cajado'){
    const shaft = document.createElementNS(NS,'rect'); shaft.setAttribute('x',62); shaft.setAttribute('y',20); shaft.setAttribute('width',6); shaft.setAttribute('height',72); shaft.setAttribute('rx',3); shaft.setAttribute('fill',col);
    g.appendChild(shaft);
    const orb = document.createElementNS(NS,'circle'); orb.setAttribute('cx',65); orb.setAttribute('cy',18); orb.setAttribute('r',12); orb.setAttribute('fill', 'url(#core-'+asset.rarity+')');
    g.appendChild(orb);
    if(asset.rarity!=='common') animateOrb(svg,orb,asset);
  } else if(key==='machado'){
    const head = document.createElementNS(NS,'rect'); head.setAttribute('x',48); head.setAttribute('y',26); head.setAttribute('width',28); head.setAttribute('height',20); head.setAttribute('rx',4); head.setAttribute('fill',col);
    g.appendChild(head);
    addSparks(svg,g,asset);
  } else if(key==='arco'){
    const path = document.createElementNS(NS,'path'); path.setAttribute('d','M40 24 q24 -18 48 0 q-6 6 -48 0 z'); path.setAttribute('fill','none'); path.setAttribute('stroke',col); path.setAttribute('stroke-width','3');
    g.appendChild(path);
    if(asset.rarity!=='common') animateCurve(svg,path);
  } else if(key==='foice'){
    const curve = document.createElementNS(NS,'path'); curve.setAttribute('d','M44 24 q32 6 28 36 q-18 -6 -28 -10 z'); curve.setAttribute('fill',col); g.appendChild(curve);
    addMist(svg,g,asset);
  } else if(key==='lança'){
    const tip = document.createElementNS(NS,'polygon'); tip.setAttribute('points','64,12 74,36 54,36'); tip.setAttribute('fill',col); g.appendChild(tip);
    const shaft = document.createElementNS(NS,'rect'); shaft.setAttribute('x',62); shaft.setAttribute('y',36); shaft.setAttribute('width',4); shaft.setAttribute('height',64); shaft.setAttribute('fill','#3b2a2a'); g.appendChild(shaft);
    if(asset.rarity!=='common') animateTip(svg,g,asset);
  }

  if(asset.rarity!=='common') {
    // add glow filter to group (subtle)
    g.setAttribute('filter','url(#glow-'+asset.rarity+')');
    g.classList.add('glowPulse');
  }
}

function drawArmorSVG(svg,g,asset){
  const NS = "http://www.w3.org/2000/svg";
  const col = rarityColor(asset.rarity);
  // chest plate stylized
  const plate = document.createElementNS(NS,'rect'); plate.setAttribute('x',36); plate.setAttribute('y',30); plate.setAttribute('width',56); plate.setAttribute('height',60); plate.setAttribute('rx',10); plate.setAttribute('fill',col); plate.setAttribute('stroke','#201020'); plate.setAttribute('stroke-width','1.5');
  g.appendChild(plate);
  const lines = document.createElementNS(NS,'path'); lines.setAttribute('d','M46 42 L86 42 M46 64 L86 64'); lines.setAttribute('stroke','#2b1b2b'); lines.setAttribute('stroke-width','1');
  g.appendChild(lines);
  if(asset.rarity!=='common'){
    g.setAttribute('filter','url(#glow-'+asset.rarity+')');
    addRunes(svg,g,asset);
  }
}

function drawCosmeticSVG(svg,g,asset){
  const NS = "http://www.w3.org/2000/svg";
  const col = rarityColor(asset.rarity);
  if(asset.key.startsWith('capa')){
    const cape = document.createElementNS(NS,'path'); cape.setAttribute('d','M34 24 q30 14 60 0 v70 h-60 z'); cape.setAttribute('fill',col); cape.setAttribute('stroke','#1f0f1f'); g.appendChild(cape);
    if(asset.rarity!=='common') animateFlow(svg,g,asset);
  } else {
    const hat = document.createElementNS(NS,'ellipse'); hat.setAttribute('cx','64'); hat.setAttribute('cy','34'); hat.setAttribute('rx','32'); hat.setAttribute('ry','14'); hat.setAttribute('fill',col); hat.setAttribute('stroke','#241422');
    g.appendChild(hat);
    if(asset.rarity!=='common') animateHatSpark(svg,g,asset);
  }
}

function drawChestSVG(svg,g,asset){
  const NS = "http://www.w3.org/2000/svg";
  const col = rarityColor(asset.rarity);
  const box = document.createElementNS(NS,'rect'); box.setAttribute('x','28'); box.setAttribute('y','40'); box.setAttribute('width','72'); box.setAttribute('height','48'); box.setAttribute('rx','6'); box.setAttribute('fill', '#5b3b2b');
  box.setAttribute('stroke','#2b1a18'); g.appendChild(box);
  const lid = document.createElementNS(NS,'rect'); lid.setAttribute('x','24'); lid.setAttribute('y','26'); lid.setAttribute('width','80'); lid.setAttribute('height','24'); lid.setAttribute('rx','6'); lid.setAttribute('fill',col); lid.setAttribute('stroke','#241511'); g.appendChild(lid);

  if(asset.rarity!=='common') {
    // animate lid glow (runic)
    const runes = document.createElementNS(NS,'g'); runes.setAttribute('fill', 'url(#core-'+asset.rarity+')');
    const r1 = document.createElementNS(NS,'circle'); r1.setAttribute('cx','64'); r1.setAttribute('cy','38'); r1.setAttribute('r','6'); runes.appendChild(r1);
    g.appendChild(runes);
    // small up-down animate on lid
    const animate = document.createElementNS(NS,'animateTransform');
    animate.setAttribute('attributeName','transform'); animate.setAttribute('type','translate'); animate.setAttribute('values','0 0; 0 -2; 0 0'); animate.setAttribute('dur','2.6s');
    animate.setAttribute('repeatCount','indefinite');
    runes.appendChild(animate);
    g.setAttribute('filter','url(#glow-'+asset.rarity+')');
  }
}

function drawMonsterSVG(svg,g,asset){
  const NS = "http://www.w3.org/2000/svg";
  const col = rarityColor(asset.rarity);
  // stylized monster body
  const body = document.createElementNS(NS,'ellipse'); body.setAttribute('cx','64'); body.setAttribute('cy','64'); body.setAttribute('rx','36'); body.setAttribute('ry','28'); body.setAttribute('fill',col); body.setAttribute('opacity','0.9'); g.appendChild(body);
  const eye = document.createElementNS(NS,'circle'); eye.setAttribute('cx','64'); eye.setAttribute('cy','58'); eye.setAttribute('r','6'); eye.setAttribute('fill','#140b14'); g.appendChild(eye);
  // aura for stronger monsters
  if(asset.rarity!=='common'){
    const aura = document.createElementNS(NS,'circle'); aura.setAttribute('cx','64'); aura.setAttribute('cy','64'); aura.setAttribute('r','44'); aura.setAttribute('fill','none'); aura.setAttribute('stroke',rarityColor(asset.rarity)); aura.setAttribute('stroke-width','3'); aura.setAttribute('opacity','0.22'); g.appendChild(aura);
    addMonsterPulse(svg,aura,asset);
  }
}

function drawInitialSVG(svg,g,asset){
  const NS = "http://www.w3.org/2000/svg";
  if(asset.key==='pijama'){
    const body = document.createElementNS(NS,'rect'); body.setAttribute('x','36'); body.setAttribute('y','30'); body.setAttribute('width','56'); body.setAttribute('height','68'); body.setAttribute('rx','10'); body.setAttribute('fill','#c9a6ff'); g.appendChild(body);
    const head = document.createElementNS(NS,'circle'); head.setAttribute('cx','64'); head.setAttribute('cy','22'); head.setAttribute('r','12'); head.setAttribute('fill','#f6e6ff'); g.appendChild(head);
  } else if(asset.key==='graveto'){
    const stick = document.createElementNS(NS,'rect'); stick.setAttribute('x','60'); stick.setAttribute('y','18'); stick.setAttribute('width','8'); stick.setAttribute('height','82'); stick.setAttribute('rx','4'); stick.setAttribute('fill','#b67b4a'); g.appendChild(stick);
    const knot = document.createElementNS(NS,'rect'); knot.setAttribute('x','56'); knot.setAttribute('y','14'); knot.setAttribute('width','16'); knot.setAttribute('height','6'); knot.setAttribute('rx','3'); knot.setAttribute('fill','#a4632f'); g.appendChild(knot);
  }
}

/* ========== small animation helpers ========== */

function addRunes(svg,g,asset){
  const NS = "http://www.w3.org/2000/svg";
  const r = document.createElementNS(NS,'text'); r.setAttribute('x','64'); r.setAttribute('y','86'); r.setAttribute('text-anchor','middle'); r.setAttribute('font-size','8'); r.setAttribute('fill', rarityColor(asset.rarity));
  r.textContent = '✦✧';
  const anim = document.createElementNS(NS,'animate'); anim.setAttribute('attributeName','opacity'); anim.setAttribute('values',
